<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title> SQL Murder Mystery >ethmcc </title>
    <meta name="author" content="Ethan McCarthy">
    <meta property="description" content="Practice your SQL commands with a fun diversion from Northwestern's Knight Labs.">
    <meta name="viewport" content="width=device-width, initial-scale=0.85">
    <link rel="apple-touch-icon" href="/icon.png">
    <meta property="og:title" content=" SQL Murder Mystery ">
    <meta property="og:description" content=" Practice your SQL commands with a fun diversion from Northwestern's Knight Labs. ">
    <meta property="og:image" content="https://ethmcc.github.io/images/vert10.jpg"/>
    <meta property="og:url" content=" https://ethmcc.github.io/sql-murder-mystery ">

    <link rel="stylesheet" href="https://ethmcc.github.io/theme/css/style.min.css?039850d7">
  </head>
  
  <body class="Site">
<header class="Site-header">
  <nav class="Nav">
    <div class="Nav-home">
      <a href="https://ethmcc.github.io">>ethmcc</a>
    </div>
    <div class="Nav-sections">
      <a class="Nav-section Nav-section--active" href="https://ethmcc.github.io/archives">/posts</a>
      <a class="Nav-section " href="https://ethmcc.github.io/projects">/projects</a>
      <a class="Nav-section " href="https://ethmcc.github.io/resume">/resume</a>
    </div>
  </nav>
  <div class="u-separator"></div>
</header>
    <div class="Site-content">
      <div class="u-container">
<div class="Page">
  <article role="main" class="Article">
    <h1 class="Article-title"> SQL Murder Mystery</h1>
    <div class="Article-meta">
      <time datetime="2020-08-01" class="Article-date">Aug 01, 2020</time>
    </div>

    <section class="Article-content">
        <p>Northwestern's Knight Labs has a fun little diversion for practicing your SQL commands.</p>
<blockquote>
<p>A crime has taken place and the detective needs your help. The detective gave you the crime scene report, but you somehow lost it. You vaguely remember that the crime was a ​murder​ that occurred sometime on ​Jan.15, 2018​ and that it took place in ​SQL City​. Start by retrieving the corresponding crime scene report from the police department’s database.</p>
</blockquote>
<p>You can check it out for yourself here: <a href="http://mystery.knightlab.com/">SQL Murder Mystery</a>.</p>
<p>Spoiler alert, here's how my experience went below:</p>
<hr>
<p>Alright, I know I want to look at the <code>crime_scene_reports</code>, but looking at the scheme table doesn't tell me what the <code>date</code> format is so I'll check first:</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">crime_scene_report</span> <span class="k">limit</span> <span class="mi">1</span>
</code></pre></div>


<div class="highlight"><pre><span></span><code>date        type    description                                         city
20180115    robbery A Man Dressed as Spider-Man Is on a Robbery Spree   NYC
</code></pre></div>


<p>Alright, looks like yyymmdd, so let's grab our crime scene report:</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span> <span class="n">description</span> <span class="k">from</span> <span class="n">crime_scene_report</span> <span class="k">where</span> <span class="k">type</span> <span class="k">is</span> <span class="s1">&#39;murder&#39;</span>
<span class="k">and</span> <span class="n">city</span> <span class="k">is</span> <span class="s1">&#39;SQL City&#39;</span> <span class="k">and</span> <span class="nb">date</span> <span class="k">is</span> <span class="s1">&#39;20180115&#39;</span>
</code></pre></div>


<div class="highlight"><pre><span></span><code>description
Security footage shows that there were 2 witnesses. The first witness lives at
the last house on &quot;Northwestern Dr&quot;. The second witness, named Annabel, lives
somewhere on &quot;Franklin Ave&quot;.
</code></pre></div>


<hr>
<div class="highlight"><pre><span></span><code><span class="k">select</span> <span class="err">\</span><span class="o">*</span> <span class="k">from</span> <span class="n">person</span>
<span class="k">where</span> <span class="n">name</span> <span class="k">like</span> <span class="s1">&#39;Annabel%&#39;</span>
<span class="k">and</span> <span class="n">address_street_name</span> <span class="k">like</span> <span class="s1">&#39;Franklin%&#39;</span>
</code></pre></div>


<div class="highlight"><pre><span></span><code>id    name           license_id address_number address_street_name ssn
16371 Annabel Miller 490173     103            Franklin Ave        318771143
</code></pre></div>


<p>If it were real life, I'd probably try both <code>asc</code> and <code>desc</code> for the "last house."</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span> <span class="err">\</span><span class="o">*</span> <span class="k">from</span> <span class="n">person</span>
<span class="k">where</span> <span class="n">address_street_name</span> <span class="k">is</span> <span class="s1">&#39;Northwestern Dr&#39;</span>
<span class="k">order</span> <span class="k">by</span> <span class="n">address_number</span> <span class="k">desc</span>
<span class="k">limit</span> <span class="mi">1</span>
</code></pre></div>


<div class="highlight"><pre><span></span><code>id    name           license_id address_number address_street_name ssn
14887 Morty Schapiro 118009     4919           Northwestern Dr     111564949
</code></pre></div>


<hr>
<p>I tried Morty's interview first and never actually went back to Annabel's (turns out she didn't have one).</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span> <span class="n">transcript</span> <span class="k">from</span> <span class="n">interview</span> <span class="k">where</span> <span class="n">person_id</span> <span class="k">is</span> <span class="mi">14887</span>
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="nv">transcript</span>
<span class="nv">I</span> <span class="nv">heard</span> <span class="nv">a</span> <span class="nv">gunshot</span> <span class="nv">and</span> <span class="k">then</span> <span class="nv">saw</span> <span class="nv">a</span> <span class="nv">man</span> <span class="nv">run</span> <span class="nv">out</span>. <span class="nv">He</span> <span class="nv">had</span> <span class="nv">a</span>
<span class="s2">&quot;</span><span class="s">Get Fit Now Gym</span><span class="s2">&quot;</span> <span class="nv">bag</span>. <span class="nv">The</span> <span class="nv">membership</span> <span class="nv">number</span> <span class="nv">on</span> <span class="nv">the</span> <span class="nv">bag</span>
<span class="nv">started</span> <span class="nv">with</span> <span class="s2">&quot;</span><span class="s">48Z</span><span class="s2">&quot;</span>. <span class="nv">Only</span> <span class="nv">gold</span> <span class="nv">members</span> <span class="nv">have</span> <span class="nv">those</span> <span class="nv">bags</span>.
<span class="nv">The</span> <span class="nv">man</span> <span class="nv">got</span> <span class="nv">into</span> <span class="nv">a</span> <span class="nv">car</span> <span class="nv">with</span> <span class="nv">a</span> <span class="nv">plate</span> <span class="nv">that</span> <span class="nv">included</span> <span class="s2">&quot;</span><span class="s">H42W</span><span class="s2">&quot;</span>.
</code></pre></div>


<p>Alright, another basic command here:</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span> <span class="n">name</span> <span class="k">from</span> <span class="n">get_fit_now_member</span>
<span class="k">where</span> <span class="n">id</span> <span class="k">like</span> <span class="s1">&#39;48Z%&#39;</span>
<span class="k">and</span> <span class="n">membership_status</span> <span class="k">is</span> <span class="s1">&#39;gold&#39;</span>
</code></pre></div>


<div class="highlight"><pre><span></span><code>name
Joe Germuska
Jeremy Bowers
</code></pre></div>


<p>Well now, not narrowed down yet. Finally we get to use some <code>join</code>s!</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span> <span class="n">get_fit_now_member</span><span class="p">.</span><span class="n">name</span> <span class="k">from</span> <span class="n">get_fit_now_member</span>
<span class="k">join</span> <span class="n">person</span> <span class="k">on</span> <span class="n">get_fit_now_member</span><span class="p">.</span><span class="n">person_id</span><span class="o">=</span><span class="n">person</span><span class="p">.</span><span class="n">id</span>
<span class="k">join</span> <span class="n">drivers_license</span> <span class="k">on</span> <span class="n">person</span><span class="p">.</span><span class="n">license_id</span><span class="o">=</span><span class="n">drivers_license</span><span class="p">.</span><span class="n">id</span>
<span class="k">where</span> <span class="n">get_fit_now_member</span><span class="p">.</span><span class="n">id</span> <span class="k">like</span> <span class="s1">&#39;48Z%&#39;</span> <span class="k">and</span> <span class="n">get_fit_now_member</span><span class="p">.</span><span class="n">membership_status</span> <span class="k">is</span> <span class="s1">&#39;gold&#39;</span>
<span class="k">and</span> <span class="n">drivers_license</span><span class="p">.</span><span class="n">plate_number</span> <span class="k">like</span> <span class="s1">&#39;%H42W%&#39;</span>
</code></pre></div>


<div class="highlight"><pre><span></span><code>name
Jeremy Bowers
</code></pre></div>


<p>There's our perp!</p>
<hr>
<p>The exercise goes on and asks you to find out the mastermind behind it, let's look to see if our perp had an interview:</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span> <span class="n">transcript</span> <span class="k">from</span> <span class="n">interview</span> <span class="k">where</span> <span class="n">person_id</span> <span class="k">is</span> <span class="mi">67318</span><span class="err">​</span>
</code></pre></div>


<div class="highlight"><pre><span></span><code>transcript
I was hired by a woman with a lot of money. I don&#39;t know her
name but I know she&#39;s around 5&#39;5&quot; (65&quot;) or 5&#39;7&quot; (67&quot;). She
has red hair and she drives a Tesla Model S. I know that she
attended the SQL Symphony Concert 3 times in December 2017.
</code></pre></div>


<p>Alright now, challenge! Let's try to do this in a single shot. We're going to have to <code>join</code> our <code>person</code> and <code>drivers_license</code> tables with the <code>facebook_event_checkin</code> table.</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span> <span class="n">name</span><span class="p">,</span> <span class="n">facebook_event_checkin</span><span class="p">.</span><span class="n">event_name</span><span class="p">,</span> <span class="n">facebook_event_checkin</span><span class="p">.</span><span class="nb">date</span>
<span class="k">from</span> <span class="n">person</span>
<span class="k">join</span> <span class="n">drivers_license</span> <span class="k">on</span> <span class="n">person</span><span class="p">.</span><span class="n">license_id</span><span class="o">=</span><span class="n">drivers_license</span><span class="p">.</span><span class="n">id</span>
<span class="k">join</span> <span class="n">facebook_event_checkin</span> <span class="k">on</span> <span class="n">facebook_event_checkin</span><span class="p">.</span><span class="n">person_id</span><span class="o">=</span><span class="n">person</span><span class="p">.</span><span class="n">id</span>
<span class="k">where</span> <span class="n">facebook_event_checkin</span><span class="p">.</span><span class="n">event_name</span> <span class="k">like</span> <span class="s1">&#39;%symphony%&#39;</span>
<span class="k">and</span> <span class="n">drivers_license</span><span class="p">.</span><span class="n">car_make</span> <span class="k">is</span> <span class="s1">&#39;Tesla&#39;</span>
<span class="k">and</span> <span class="n">drivers_license</span><span class="p">.</span><span class="n">car_model</span> <span class="k">is</span> <span class="s1">&#39;Model S&#39;</span>
<span class="k">and</span> <span class="n">drivers_license</span><span class="p">.</span><span class="n">hair_color</span> <span class="k">is</span> <span class="s1">&#39;red&#39;</span>
<span class="k">and</span> <span class="n">drivers_license</span><span class="p">.</span><span class="n">gender</span> <span class="k">is</span> <span class="s1">&#39;female&#39;</span>
</code></pre></div>


<div class="highlight"><pre><span></span><code>name             event_name           date
Miranda Priestly SQL Symphony Concert 20171206
Miranda Priestly SQL Symphony Concert 20171212
Miranda Priestly SQL Symphony Concert 20171229
</code></pre></div>


<p>There's our three visits in 2017!</p>
</details>
    </section>


    <p class="Article-tags">tagged in
      <a href="https://ethmcc.github.io/tag/sql.html">sql</a>
      <a href="https://ethmcc.github.io/tag/databases.html">databases</a>
    </p>

  </article>
</div>
<div id="progress" class="Progress"></div>
      </div>
    </div>

<footer class="Site-footer">
  <div class="u-separator"></div>
</footer>
  <script src="https://ethmcc.github.io/theme/webassets-external/d25734465c6073ad0c9cfd9a468e4ca9_progress.js"></script>
  </body>
</html>